<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8" http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Everit Component Model</title>
<link rel="icon" type="image/ico" href="../fonts/favicon.ico">
<!-- Bootstrap core CSS -->
<link href="../css/bootstrap.min.css" rel="stylesheet">

<!-- Documentation extras -->
<link href="../css/docs.min.css" rel="stylesheet">
<link href="../css/everit.css" rel="stylesheet">

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
    <script src="../js/html5shiv.min.js"></script>
    <script src="../js/respond.min.js"></script>
    <script src="../js/respond.matchmedia.addListener.min.js"></script>
    <![endif]-->

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push([ '_setAccount', 'UA-15041869-4' ]);
  _gaq.push([ '_setDomainName', 'everit.org' ]);
  _gaq.push([ '_trackPageview' ]);
</script>
<style type="text/css">
.ecm-chapter {
    text-align: justify;
}
</style>
</head>

<body class="bs-docs-home" data-spy="scroll" data-target="#affix-nav">
  <a class="sr-only" href="#content">Skip to main content</a>

  <!-- Docs master nav -->
  <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse"
          data-target=".bs-navbar-collapse">
          <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span
            class="icon-bar"></span> <span class="icon-bar"></span>
        </button>
        <a href="index.html" class="navbar-brand ">Everit</a>
      </div>
      <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
        <ul class="nav navbar-nav ">
          <li><a href="../components.html ">Components</a></li>
          <li><a href="../documentation.html">Documentation</a></li>
          <li><a href="../oldsite.html ">Old site</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right ">
          <li><a href="http://www.everit.biz " target="_blank">Enterprise</a></li>
          <li><a href="http://everitorg.wordpress.com/ " target="_blank">Blog</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="bs-docs-masthead everit-header" id="content" role="main">
    <div class="container ">
      <span class="bs-docs-booticon bs-docs-booticon-lg bs-docs-booticon-outline "> <img
        class="logo " src="../fonts/sbz_e.svg" alt="E">
      </span>
      <p class="lead ">Everit Component Model</p>
    </div>
  </div>
  <div class="container">
    <div class="col-md-10">
      <div class="bs-docs-featurette ecm-chapter">
        <h2 id="introduction" class="bs-docs-featurette-title ">Introduction</h2>
        <p>
          ECM is a <a href="http://wiki.osgi.org/wiki/Component_Models_Overview">component model</a>
          designed to work well in large OSGi based applications. Developers who have used <a
            href="http://wiki.osgi.org/wiki/Declarative_Services">Declarative Services</a> before
          will find the concept of ECM familiar.
        </p>
        <p>
          While modularization gives <a href="http://www.osgi.org/Technology/WhyOSGi">lots of
            benefits</a> to a project, developers often feel that the application skeleton is similar to
          a house of cards. If any of the component has an issue, part of the system collapses, and
          it is nearly impossible to find the origin of the problem. One of the goals of Everit
          Component Model is to help developers finding the cause of issues in OSGi.
        </p>
        <p>
          Instead of <a href="http://wiki.osgi.org/wiki/Whiteboard_Pattern">whiteboard pattern</a>,
          ECM supports the top-down configuration approach. While developers can wire components
          together with whiteboard pattern rapidly, they lose the ability of efficient issue
          detection. E.g.: If part of an application cannot start without any meaningful exception,
          it is hard to find the missing piece. Searching the issue is even more difficult when one
          has to fix a problem in an application that was written by other.
        </p>
        <p>With top-down configuration design, developers can start searching the problem from
          the top of the application skeleton and by walking down on the unsatisfied component
          graph, they can find the original cause of the issue rapidly. With ECM, designing OSGi
          based applications becomes easier and more fun.</p>
      </div>
      <div class="bs-docs-featurette ecm-chapter">
        <h2 id="quickstart" class="bs-docs-featurette-title ">Quick start</h2>
        <p>There are several ways to use the Everit Component Model. The easiest way is using
          OSGi extender pattern, while components can be created and started programmatically, too.</p>
        <h3 id="usage-extender">Using the Extender</h3>
        <p>During development time, add the following dependencies (with their dependencies
          transitively):</p>
        <ul>
          <li><p>
              <a href="#ecm-annotation">ecm-annotation</a>
            </p></li>
          <li><p>
              <a href="#ecm-extender-api">ecm-extender-api</a>
            </p></li>
          <li><p>
              <a href="#ecm-component-api">ecm-component-api</a> if any of the classes from the API
              is used within the component (E.g.: <a
                href="http://www.everit.org/ecm-component-api/apidocs/org/everit/osgi/ecm/component/ComponentContext.html">ComponentContext</a>).
            </p></li>
        </ul>

        <p>To be picked up by the extender, the component class must be annotated in the
          following way:</p>
        <pre class="prettyprint lang-java">import org.everit.osgi.ecm.annotation.Component;
import org.everit.ecm.annotation.Service;
import org.everit.ecm.annotation.ServiceRef;
import org.everit.osgi.ecm.component.ServiceHolder;
import org.everit.osgi.ecm.extender.ExtendComponent;

@Component
@Service
@ExtendComponent
@StringAttributes(@StringAttribute(attributeId = "service.description", value = "My Component"))
public class MyComponent {

  private MyService myService;

  /**
   * Example of specifying a service reference on a setter. The programmer can use the annotation
   * on the member variable and in front of the class in @ServiceRefs annotation, too.
   */
  @ServiceRef
  public void setMyService(MyType myService) {
    this.myService = myService;
  }
  
  @ServiceRef
  public void setMyServiceWithInfo(ServiceHolder&lt;MyType&gt; myServiceHolder) {
    // The programmer can get additional information if ServiceHolder is used instead of the type
    // of the service itself. E.g.: The service properties, attributes and directives of the
    // configuration of the reference.
  }

  @ServiceRef
  public void setMyMultiService(MyType[] myServices) {
    // If the parameter type is an array, the cardinality of the reference will be multiple. Usage
    // of ServiceHolder array is also possible as parameter type.
  }

  @Activate
  public void activate() {
    // This is a sample activate method. Possible parameters: Componentcontext, BundleContext and
    // Map. The programmer can also define update and deactivate methods.
    
    // The programmer can register additional OSGi service programmatically via ComponentContext.
    // In case a service is programmatically registered, it should be shown in front of the class
    // in the @ManualServices annotation.
  }

}</pre>
        <p>
          The documentation of all annotations is available in <a
            href="http://www.everit.org/ecm-annotation/apidocs/index.html">javadoc</a>.
        </p>
        <p>
          With a build tool that uses <i>bndlib</i> inside, the necessary MANIFEST header will be
          automatically generated. Such tools are bndtools and maven-bundle-plugin. If this
          automation is not available, the <i>Require-Capability</i> header must be manually
          defined:
        </p>
        <pre class="prettyprint">Require-Capability: osgi.extender;osgi.extender=org.everit.osgi.ecm.component;class="mypackage.MyComponent"</pre>
        <p>By having the necessary MANIFEST header, the ECM Extender will automatically pick up
          the specified class and look for annotations.</p>
        <p>In the runtime environment, the following OSGi bundle should be installed with its
          dependencies:</p>
        <ul>
          <li><p>
              <a href="#ecm-extender-ri">extender-ri</a>
            </p></li>
        </ul>
        <h3 id="usage-bnd">
          Adding the Bnd plugin
          </h4>
          <p>
            The <a href="ecm-bnd-plugin">Bnd plugin</a> can generate additional <i>Provide-Capability</i>
            MANIFEST header entries based on ECM annotations. Some repositories index the <i>Provide-Capability</i>
            header and makes it possible to users searching based on the information in them.
          </p>
          <p>
            In case of <i>maven-bundle-plugin</i> the <a href="ecm-bnd-plugin">Bnd plugin</a> should
            be configured in the following way:
          </p>
          <pre class="prettyprint lang-xml">
&lt;plugin&gt;
  &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
  &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;
  &lt;configuration&gt;
    &lt;instructions&gt;
      <strong>&lt;_plugin&gt;org.everit.osgi.ecm.bnd.ECMBndAnalyzerPlugin&lt;/_plugin&gt;</strong>
    &lt;/instructions&gt;
  &lt;/configuration&gt;
  &lt;dependencies&gt;
    <strong>&lt;dependency&gt;
      &lt;groupId&gt;org.everit.osgi&lt;/groupId&gt;
      &lt;artifactId&gt;org.everit.osgi.ecm.annotation.bnd&lt;/artifactId&gt;
      &lt;version&gt;3.0.0&lt;/version&gt;
    &lt;/dependency&gt;</strong>
  &lt;/dependencies&gt;
&lt;/plugin&gt;</pre>
          <p class="bg-danger">If you use other Bnd based build tools (e.g.: the gradle plugin) and you figured out how to
            configure the Bnd plugin, do not hesitate to send a Pull Request to this documentation
            on Github!</p>
          <h3 id="usage-programmatic">Programmatic way</h3>
          <p>Everit Component Model is designed in the way that Components can be created
            programmatically, too. During the development and also on the running OSGi container,
            the following OSGi bundle with its dependencies should be used:</p>
          <ul>
            <li><p>
                <a href="#ecm-component-ri">ecm-component-ri</a>
              </p></li>
          </ul>
          <p>
            In the following example, a very simple <a href="#component-container">ECM Component
              Container</a> is created and started within a Bundle-Activator:
          </p>
          <pre class="prettyprint lang-java">
import org.everit.osgi.ecm.component.ri.ComponentContainerFactory;
import org.everit.osgi.ecm.component.ri.ComponentContainerInstance;
import org.everit.osgi.ecm.metadata.ComponentMetadata;
import org.everit.osgi.ecm.metadata.ComponentMetadata.ComponentMetadataBuilder;
import org.osgi.framework.BundleActivator;
import org.osgi.framework.BundleContext;

public class MyActivator {

  private ComponentContainerInstance&lt;MyComponent&gt; myComponentContainer

  @Override
  public void start(final BundleContext context) {
    ComponentMetadataBuilder builder = new ComponentMetadataBuilder();
    ComponentMetadata metadata = builder.withType(MyComponent.class.getName()).build();

    ComponentContainerFactory factory = new ComponentContainerFactory(context);

    this.myComponentContainer = factory.createComponentContainer(metadata);
    this.myComponentContainer.open();
  }

  @Override
  public void stop(final BundleContext context) {
    this.myComponentContainer.close();
  }
}</pre>
          <p>
            For more information, how to build <a
              href="http://www.everit.org/ecm-metadata/apidocs/org/everit/osgi/ecm/metadata/ComponentMetadata.html">ComponentMetadata</a>
            programmatically, see the documentation of <a href="#ecm-metadata">ecm-metadata</a> OSGi
            bundle!
          </p>
      </div>
      <div class="bs-docs-featurette ecm-chapter">
        <h2 id="specification" class="bs-docs-featurette-title ">Specification</h2>
        <h3 id="component-metadata">Component metadata</h3>
        <p>
          Its <a href="http://www.everit.org/ecm-metadata/apidocs/index.html">metadata</a> describes
          a component. The programmer must pass the metadata to the <a href="#component-container">component
            container</a> during its instantiation. The <i>metadata</i> contains all information about
          configurability, the attributes and the requirements of the component.
        </p>
        <p>The programmer can specify the following settings for a component:</p>
        <div class="responsive-table">
          <div class="row hidden-xs">
            <div class="col-sm-5 col-md-4 col-lg-3">
              <b>Metadata property</b>
            </div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <b>Description</b>
            </div>
          </div>
          <hr class="double-hr hidden-xs" />
          <div class="empty-separator visible-xs">&nbsp;</div>
          <div id="component-id" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Id</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The id of the component. If not defined, the id of the component will be the fully
              qualified name of the <a href="#component-class">component class</a>.
            </div>
          </div>
          <hr />
          <div id="component-class" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Class</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The type that the component. The specified class will be instantiated by the <a
                href="#component-context">component context</a> when all references become
              satisfied.
            </div>
          </div>
          <hr />
          <div id="configuration-policy" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Configuration Policy</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <p>Can have one of the following values:</p>
              <ul>
                <li><p>
                    <strong id="policy-ignore">IGNORE</strong>: Neither ManagedService nor
                    ManagedServieFactory interface is used when the ComponentContainer OSGi service
                    is registered. The container instantiates and opens the <a
                      href="#component-context">Component Context</a> as soon as the container is
                    opened and all references of the component are satisfied.
                  </p></li>
                <li><p>
                    <strong id="policy-optional">OPTIONAL</strong>: One <a href="#component-context">Component
                      Context</a> will be instantiated and opened as soon as the <i>Container</i> is
                    started. In case a configuration is available, the Component Context will be
                    upgraded. <strong><span class="text-danger">Although this is the
                        default policy for components, we do not recommend using it. Strange
                        behavior can happen. E.g.: A component is created while starting the
                        framework than it is re-activated (and all dependent components are
                        re-activated recursively) when Configuration Admin starts.</span></strong>
                  </p></li>
                <li><p>
                    <strong id="policy-required">REQUIRED</strong>: The <a href="#component-context">Component
                      Context</a> will be instantiated and opened only if a configuration is available.
                    If the configuration is not available anymore, the <i>Container</i> closes the <a
                      href="#component-context">Component Context</a>.
                  </p></li>
                <li><p>
                    <strong id="policy-factory">FACTORY</strong>: The <i>Container</i> will
                    instantiate and open as many <a href="#component-context">Component Contexts</a>
                    as many configuration is available.
                  </p></li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="configuration-pid" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Configuration PID</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <p>
                If the <a href="#configuration-policy">configuration policy</a> of the component is
                <a href="#policy-optional">OPTIONAL</a> or <a href="#policy-required">REQUIRED</a>,
                configurations with the same Persistent-Id can be attached to the component.
              </p>
              <p>
                If the <a href="#configuration-policy">configuration policy</a> of the component is
                <a href="#policy-factory">FACTORY</a>, configuration sets with the same Factory PID
                can be attached to the component.
              </p>
              <p>
                By default, this setting has the same value as the <a href="#component-id">component
                  id</a>.
              </p>
            </div>
          </div>
          <hr />
          <div id="component-metadata-attribute" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Attributes</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              Specifies the <a href="#component-attribute">attributes</a> of the component.
            </div>
          </div>
          <hr />
          <div id="component-metadata-reference" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">References</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              Specifies the <a href="#component-reference">references</a> of the component.
            </div>
          </div>
          <hr />
          <div id="component-metadata-service" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Service</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The <a href="#component-context">component context</a> registers the component
              instance at the end of the <a href="#state-starting">starting process</a> as an OSGi
              service with the specified types. If no type is specified, the <a
                href="#component-context">component context</a> will not install the component
              instance as an OSGi service.
            </div>
          </div>
          <hr />
          <div id="component-metadata-manual-service" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Manual service</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              List of types that are used to register programmatically OSGi services via the <a
                href="http://www.everit.org/ecm-component-api/apidocs/org/everit/osgi/ecm/component/ComponentContext.html">component
                context</a> of the component. This setting has informational purposes for tools that can
              give tips which components could satisfy an unsatisfied component.
            </div>
          </div>
          <hr />
          <div id="component-metadata-activate" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Activate method</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The <a
                href="http://www.everit.org/ecm-util-method/apidocs/org/everit/osgi/ecm/util/method/MethodDescriptor.html">descriptor</a>
              of the <a href="#activate-method">activate method</a> of the component.
            </div>
          </div>
          <hr />
          <div id="component-metadata-update" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Update method</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The <a
                href="http://www.everit.org/ecm-util-method/apidocs/org/everit/osgi/ecm/util/method/MethodDescriptor.html">descriptor</a>
              of the <a href="#update-method">update method</a> of the component.
            </div>
          </div>
          <hr />
          <div id="component-metadata-deactivate" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Deactivate method</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The <a
                href="http://www.everit.org/ecm-util-method/apidocs/org/everit/osgi/ecm/util/method/MethodDescriptor.html">descriptor</a>
              of the <a href="#dectivate-method">deactivate method</a> of the component.
            </div>
          </div>
          <hr />
          <div id="component-metatadata-metatype" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Metatype</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              If <i>true</i>, the <a href="#component-container">component container</a> OSGi
              service is registered with the <a
                href="https://osgi.org/javadoc/r4v42/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
              interface.
            </div>
          </div>
          <hr />
          <div id="component-localizationbase" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Localization base</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The component and the attributes can have labels and descriptions. The developer can
              translate these human-readable texts to different languages. When a label or
              description is prepended with the '%' character, the registered <a
                href="https://osgi.org/javadoc/r4v42/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
              service first looks for the value in the attached <a
                href="http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html">resource
                bundle</a>. The location of the <i>resource bundle</i> is specified by the <i>localization
                base</i> metadata setting.
            </div>
          </div>
          <hr />
          <div id="component-metadata-label" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Label</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <p>
                Human readable format of the <a href="#component-id">component id</a>. The label is
                accessible via the <a
                  href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                OSGi service that is registered together with the <a href="#component-container">component
                  container</a> if the value of the <a href="#component-metadata-metatype">metatype</a>
                setting is true.
              </p>
              <p>
                If the label starts with the '<i>%</i>' character, the actual value is read from the
                resource bundle that is attached to the component. If the resource bundle does not
                contain the entry with the specific key, the value without the '<i>%</i>' character
                is returned by the <a
                  href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                OSGi service.
              </p>
              <p>
                The default value of the label attribute setting is the concatenation of a '<i>%</i>'
                character, the <a href="#component-id">component id</a> and the String "<i>.name</i>".
                E.g.: If the component id is "<i>MyComponent</i>", the default value of the label
                will be "<i>%MyComponent.name</i>"
              </p>
            </div>
          </div>
          <hr />
          <div id="component-metadata-description" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Description</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <p>
                The description of the component. The description is accessible via the <a
                  href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                OSGi service that is registered together with the <a href="#component-container">component
                  container</a> if the value of the <a href="#component-metadata-metatype">metatype</a>
                setting is true.
              </p>
              <p>
                If the description starts with the '<i>%</i>' character, the actual value is read
                from the resource bundle that is attached to the component. If the resource bundle
                does not contain the entry with the specific key, the value without the '<i>%</i>'
                character is returned by the <a
                  href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                OSGi service.
              </p>
              <p>
                The default value of the description attribute setting is the concatenation of a '<i>%</i>'
                character, the <a href="#component-id">component id</a> and the String "<i>.description</i>".
                E.g.: If the component id is "<i>MyComponent</i>", the default value of the
                description will be "<i>%MyComponent.description</i>"
              </p>
              <p>
                This setting is ignored if the value of the <a href="#component-metadata-metatype">metatype</a>
                setting is false.
              </p>
            </div>
          </div>
          <hr />
          <div id="component-icons" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">Icons</div>
            <div class="col-sm-7 col-md-8 col-lg-9">Location of icon files on the classpath
              that the Webconsole or any other OSGi management tool can show next to the component
              or its attached configuration.</div>
          </div>
        </div>



        <h3 id="component-container">Component container</h3>
        <p>
          A <i>Component Container</i> is responsible for the instantiation and lifecycle of <a
            href="#component-context">Component Contexts</a>. When the <i>Component Container</i> is
          opened, an OSGi service is registered with the following interfaces:
        </p>
        <div class="responsive-table">
          <div class="row hidden-xs">
            <div class="col-sm-3 col-lg-6">
              <b>Interface</b>
            </div>
            <div class="col-sm-9 col-lg-6">
              <b>Description</b>
            </div>
          </div>
          <hr class="double-hr hidden-xs" />
          <div class="empty-separator visible-xs">&nbsp;</div>
          <div class="row">
            <div class="col-sm-3 col-lg-6">
              <a
                href="http://www.everit.org/ecm-component-api/apidocs/org/everit/osgi/ecm/component/resource/ComponentContainer.html">
                <span class="hidden-xs hidden-sm hidden-md">org.everit.osgi.ecm.component.resource.</span>ComponentContainer
              </a>
            </div>
            <div class="col-sm-9 col-lg-6">
              Used to retrieve all information about the state of the container instance.
              Programmers can list the instantiated components, get the <i>metadata</i> that belongs
              to the component, etc.
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3 col-lg-6">
              <a href="https://osgi.org/javadoc/r4v42/org/osgi/service/cm/ManagedService.html"><span
                class="hidden-xs hidden-sm hidden-md">org.osgi.service.cm.</span>ManagedService</a>
            </div>
            <div class="col-sm-9 col-lg-6">
              Only if the <a href="#configuration-policy">configuration policy</a> of the container
              is either <a href="#policy-optional">OPTIONAL</a> or <a href="#policy-required">REQUIRED</a>
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3 col-lg-6">
              <a
                href="https://osgi.org/javadoc/r4v42/org/osgi/service/cm/ManagedServiceFactory.html"><span
                class="hidden-xs hidden-sm hidden-md">org.osgi.service.cm.</span>ManagedServiceFactory</a>
            </div>
            <div class="col-sm-9 col-lg-6">
              Only if the <a href="#configuration-policy">configuration policy</a> of the container
              is <a href="#policy-factory">FACTORY</a>.
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3 col-lg-6">
              <a
                href="https://osgi.org/javadoc/r4v42/org/osgi/service/metatype/MetaTypeProvider.html"><span
                class="hidden-xs hidden-sm hidden-md">org.osgi.service.metatype.</span>MetaTypeProvider</a>
            </div>
            <div class="col-sm-9 col-lg-6">
              Only if the <i>metatype</i> data belongs to the container.
            </div>
          </div>
        </div>
        <p>
          ECM relies on the <i>Configuration Admin</i> chapter of <i>OSGi Compendium
            Specification</i>. If any configuration is necessary, <i>ComponentContainer</i> OSGi service
          is registered with <i>ManagedService</i> or <i>ManagedServiceFactory</i> interface. <i>Configuration
            Admin</i> notifies the <i>Component Container</i> by calling the OSGi service if a new
          configuration is available; a configuration was modified, or a configuration was deleted.
          The behavior of the Component Container depends on the <a href="#configuration-policy">configuration
            policy</a>.
        </p>
        <div class="clearfix">
          <div class="col-xs-10 col-xs-offset-1 col-md-5 col-md-offset-0 text-center"
            style="padding-bottom: 1em;">
            <img alt="Container-Context relation with Factory configuration policy"
              style="max-width: 100%;" src="container-context-factory.svg">
          </div>
          <div class="col-xs-10 col-xs-offset-1 col-md-5 col-md-offset-1 text-center"
            style="padding-bottom: 1em;">
            <img
              alt="Container-Context relation with Ignore, Optional or Required configuration policy"
              style="max-width: 100%;" src="container-context-simple.svg">
          </div>
        </div>
        <h3 id="component-context">Component context</h3>

        <p>
          <i>Component contexts</i> are instantiated and started by the <a
            href="#component-container">Component containers</a>. One <i>Component context</i>
          handles the lifecycle of exactly one <i>Component</i>.
        </p>
        <p>
          The <a href="#component-context">ComponentContext</a> instance can be used within a
          component to
        </p>
        <ul>
          <li>get the current configuration of the component</li>
          <li>access the <i>metadata</i> of the component via the <i>component container</i>
          <li>access the <a
            href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/BundleContext.html">BundleContext</a>
            of the bundle that registered the <i>component container</i>
          <li>register OSGi services</li>
        </ul>
        <p>
          <strong class="text-danger">Component developers should always register OSGi
            services via <i>ComponentContext</i> and not via <i>BundleContext</i>!
          </strong> ECM can provide complete <a href="#component-reference">Component wiring</a> information
          only if OSGi services are registered via <i>ComponentContext</i>.
        </p>
        <p>
          Component developers can receive the <i>component context</i> by specifying it as a
          parameter of the <a href="#activate-method">activate</a> method of the component.
        </p>


        <h3 id="component-lifecycle">Component lifecycle</h3>
        <h4 id="component-states">Component states</h4>
        <p>
          The <a href="#component-context">component context</a> manages the lifecycle of the
          component. A component might have one of the following states:
        </p>
        <div class="responsive-table">
          <div class="row hidden-xs">
            <div class="col-sm-5 col-md-4 col-lg-3">
              <b>State</b>
            </div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <b>Description</b>
            </div>
          </div>
          <hr class="double-hr hidden-xs" />
          <div class="empty-separator visible-xs">&nbsp;</div>
          <div id="state-inactive" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">INACTIVE</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The <a href="#component-context">component context</a> that manages this component is
              closed.
            </div>
          </div>
          <hr />
          <div id="state-unsatisfied" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">UNSATISFIED</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The component has one or more unsatisfied <a href="#component-reference">requirements</a>.
            </div>
          </div>
          <hr />
          <div id="state-starting" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">STARTING</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <p>
                The <a href="#component-context">component context</a> is starting the component.
                The starting process contains the following steps:
              </p>
              <ol>
                <li>The <a href="#component-context">component context</a> instantiates the <i>component</i>
                  class.
                </li>
                <li>The <a href="#component-context">component context</a> calls the setters of
                  the <i>component instance</i>
                </li>
                <li>The <a href="#activate-method">Activate</a> method of the <i>component
                    instance</i> method is called
                </li>
                <li>The <i>Component context</i> registers the <i>component instance</i> as an
                  OSGi service if automatic service registration is defined.
                </li>
              </ol>
            </div>
          </div>
          <hr />
          <div id="state-active" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">ACTIVE</div>
            <div class="col-sm-7 col-md-8 col-lg-9">The component is active, and if defined
              so, it is registered as an OSGi service.</div>
          </div>
          <hr />
          <div id="state-updating-configuration" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">UPDATING_CONFIGURATION</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              The <a href="#component-container">component container</a> is currently updating
              non-dynamic attributes on the <a href="#component-context">component context</a>.
            </div>
          </div>
          <hr />
          <div id="state-stopping" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">STOPPING</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <p>
                The <a href="#component-context">component context</a> started the stopping process
                on the component instance but has not finished yet. The stopping process runs the
                following steps:
              </p>
              <ol>
                <li>The <a href="#component-context">component context</a> unregisters the OSGi
                  service that was automatically registered based on the component instance (if
                  automatic service registration was defined).
                </li>
                <li>The <a href="#component-context">component context</a> calls the <a
                  href="#deactivate-method">deactivate method</a> on the <i>component instance</i>
                  if one defined.
                </li>
                <li>The <a href="#component-context">component context</a> checks whether all
                  OSGi services were unregistered by the <a href="#deactivate-method">deactivate
                    method</a> that were registered with the functions of the <a
                  href="#component-context">component context</a>. If not, the <a
                  href="#component-context">component context</a> unregisters them and writes a <i>WARN</i>
                  message into the log.
                </li>
              </ol>
            </div>
          </div>
          <hr />
          <div id="state-failed" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">FAILED</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              An exception was thrown by
              <ul>
                <li>the <a href="#component-context">component context</a> while validating the
                  configuration of the component.
                </li>
                <li>any of the <a href="#setter-method">setter methods</a> of the <i>component
                    instance</i>.
                </li>
                <li>the <a href="#activate-method">activate method</a> of the <i>component
                    instance.</i></li>
                <li>the <a href="#update-method">update method</a> of the <i>component
                    instance.</i></li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="state-failed-permanent" class="row">
            <div class="col-sm-5 col-md-4 col-lg-3">FAILED_PERMANENT</div>
            <div class="col-sm-7 col-md-8 col-lg-9">
              <p>
                The component will be permanently failed if <i>metadata</i> of the component is
                inconsistent. E.g.:
              </p>
              <ul>
                <li>The class of the component cannot be found or instantiated.</li>
                <li>Specified <i>Activate</i>, <i>Update</i> or <i>Deactivate</i> method does
                  not exist
                </li>
                <li>Any of the specified setters does not exist</li>
              </ul>
            </div>
          </div>
        </div>
        <div id="state-dynamic-update" class="row">
          <div class="col-sm-5 col-md-4 col-lg-3">Dynamic update</div>
          <div class="col-sm-7 col-md-8 col-lg-9">
            <p>
              <i>Dynamic update</i> happens when the <a href="#component-context">component
                context</a> updates the component instance without leaving the <a href="#state-active">ACTIVE</a>
              state. That means that <i>Dynamic update</i> is not a state that appears to the user.
              If the update is successful, the process runs without changing the state of the
              component. The <i>Dynamic update</i> process executes the following steps:
            </p>
            <ul>
              <li>Calls the setters of the attributes and references that has been changed</li>
              <li>Calls the <a href="#update-method">update method</a> of the component
                instance if one is implemented
              </li>
            </ul>
          </div>
        </div>
        <h4 id="state-transitions">State transitions</h4>
        <div class="text-center" style="padding-top: 1em;">
          <img alt="Component Lifecycle Diagram" src="lifecycle.svg" style="max-width: 100%;">
        </div>
        <div class="responsive-table">
          <div class="row hidden-xs">
            <div class="col-sm-5 col-lg-4">
              <b>Transition</b>
            </div>
            <div class="col-sm-7 col-lg-8">
              <b>Description</b>
            </div>
          </div>
          <hr class="double-hr hidden-xs" />
          <div class="empty-separator visible-xs">&nbsp;</div>
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>1:</strong> <a href="#state-inactive">INACTIVE</a> &rarr;&nbsp;<a
                  href="#state-starting">STARTING</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              If all of the <a href="#component-requirement">requirements of the component</a> are
              satisfied, the <a href="#state-starting">starting process</a> will start.
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>2:</strong> <a href="#state-inactive">INACTIVE</a> &rarr;&nbsp;<a
                  href="#state-unsatisfied">UNSATISFIED</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              If any of the <a href="#component-reference">requirements</a> of the component is
              unsatisfied, the component becomes <a href="#state-unsatisfied">UNSATISFIED.</a>
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>3:</strong> <a href="#state-unsatisfied">UNSATISFIED</a> &rarr;&nbsp;<a
                  href="#state-starting">STARTING</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              The component context calls the <a href="#state-starting">starting process</a> if all
              <a href="#component-requirement">requirements</a> become satisfied.
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>4:</strong> <a href="#state-starting">STARTING</a> &rarr;&nbsp;<a
                  href="#state-failed">FAILED</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              <p>
                The <a href="#state-starting">starting process</a> fails if
              </p>
              <ul>
                <li>an exception is thrown during the instantiation of the component class.</li>
                <li>the type of the value of any of the attributes does not match with the
                  defined type of the attribute</li>
                <li>any of the specified <a href="#setter-method">setter methods</a> of the
                  component instance throws an exception.
                </li>
                <li>the <a href="#activate-method">activate method</a> throws an exception
                </li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>5:</strong> <a href="#state-failed">FAILED</a> &rarr;&nbsp;<a
                  href="#state-starting">STARTING</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              <p>
                The <a href="#component-context">component context</a> tries to start a <a
                  href="#state-failed">FAILED</a> component if
              </p>
              <ul>
                <li>the configuration is changed</li>
                <li>the wirings to the <a href="#component-requirement">requirements of the
                    component</a> are changed (e.g.: the OSGi service that would satisfy a service
                  reference is replaced by other one)
                </li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>6:</strong> <a href="#state-starting">STARTING</a> &rarr;&nbsp;<a
                  href="#state-active">ACTIVE</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              The component becomes <a href="#state-active">ACTIVE</a> if the <a
                href="#state-starting">starting process</a> finishes successfully.
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>7:</strong> <a href="#state-active">ACTIVE</a>
                &rarr;&nbsp;Dynamic&nbsp;update
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              <p>
                The <a href="#component-context">component context</a> <a
                  href="#state-dynamic-update">updates the component dynamically</a> if
              </p>
              <ul>
                <li>the configuration that belongs to the component instance is updated and
                  only dynamic attributes are changed</li>
                <li>the configuration that belongs to the component instance is updated and
                  only the configuration of dynamic requirements are changed in the way that all of
                  the requirements are satisfied with the new configuration (e.g.: an OSGi service
                  is unregistered but there is another one that satisfies the component)</li>
                <li>if a capability that is wired to one of the dynamic requirement of the
                  component is replaced by another capability</li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>8:</strong> Dynamic&nbsp;update &rarr;&nbsp;<a href="#state-active">ACTIVE</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              If the <a href="#state-dynamic-update">dynamic update process</a> is successful, the
              component state remains <a href="#state-active">ACTIVE</a>.
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>9:</strong> Dynamic&nbsp;update &rarr;&nbsp;<a href="#state-stopping">STOPPING</a>
                &rarr;&nbsp;<a href="#state-failed">FAILED</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              If any of the <a href="#setter-method">setter methods</a> or the <a
                href="#update-method">update method</a> of the component instance throws an
              exception, the <a href="#component-context">component context</a> <a
                href="#state-stopping">stops</a> the component instance and the component will get
              the <a href="#state-failed">FAILED</a> state.
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>10:</strong> <a href="#state-active">ACTIVE</a> &rarr;&nbsp;<a
                  href="#state-stopping">STOPPING</a> &rarr;&nbsp;<a
                  href="#state-updating-configuration">UPDATING_CONFIGURATION</a> &rarr;&nbsp;<a
                  href="#state-starting">STARTING</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">When non-dynamic attributes or non-dynamic
              references are changed, the component is restarted with the new configuration.</div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>11:</strong> <a href="#state-active">ACTIVE</a> &rarr;&nbsp;<a
                  href="#state-stopping">STOPPING</a> &rarr;&nbsp;<a href="#state-unsatisfied">UNSATISFIED</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              When one of the <a href="#component-requirement">requirements</a> of an <a
                href="#state-active">ACTIVE</a> component becomes unsatisfied, the component is <a
                href="#state-stopping">stopped</a> and becomes <a href="#state-unsatisfied">UNSATISFIED</a>.
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>12:</strong> <a href="#state-active">ACTIVE</a> &rarr;&nbsp;<a
                  href="#state-stopping">STOPPING</a> &rarr;&nbsp;<a href="#state-inactive">INACTIVE</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              <p>
                When the <a href="#component-context">component context</a> is closed, and the
                component is <a href="#state-active">ACTIVE</a>, the <a href="#component-context">component
                  context</a>
              </p>
              <ul>
                <li><a href="#state-stopping">stops</a> the component,</li>
                <li>and sets the state of itself to <a href="#state-inactive">INACTIVE</a></li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>13:</strong> <a href="#state-failed">FAILED</a> &rarr;&nbsp;<a
                  href="#state-inactive">INACTIVE</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              <p>
                When the <a href="#component-context">component context</a> is closed, and the
                component is <a href="#state-failed">FAILED</a>, the <a href="#component-context">component
                  context</a>
              </p>
              <ul>
                <li>sets the state of itself to <a href="#state-inactive">INACTIVE</a></li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="transition-inactive-starting" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>14:</strong> <a href="#state-unsatisfied">UNSATISFIED</a> &rarr;&nbsp;<a
                  href="#state-inactive">INACTIVE</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              <p>
                When the <a href="#component-context">component context</a> is closed and the
                component is <a href="#state-unsatisfied">UNSATISFIED</a>, the <a
                  href="#component-context">component context</a>
              </p>
              <ul>
                <li>sets the state of itself to <a href="#state-inactive">INACTIVE</a></li>
              </ul>
            </div>
          </div>
          <hr />
          <div id="transition-starting-failed_permanent" class="row">
            <div class="col-sm-5 col-lg-4">
              <div class="state-transition-label">
                <strong>15:</strong> <a href="#state-starting">STARTING</a> &rarr;&nbsp;<a
                  href="#state-failed-permanent">FAILED_PERMANENT</a>
              </div>
            </div>
            <div class="col-sm-7 col-lg-8">
              <p>
                If the there is an exception that can be expected every time the component would <a
                  href="#state-starting">start</a>, the <a href="#component-context">component
                  context</a> sets the <a href="#state-failed-permanent">FAILED PERMANENT</a> state.
                After having this state, the <a href="#component-context">component context</a> will
                ignore any configuration or <a href="#component-requirement">requirement</a> change.
                Such exception can be an <i>IllegalAccessException</i> during the component
                instantiation.
              </p>
            </div>
          </div>

          <h3 id="component-attributes">Component attributes</h3>
          <h4 id="attribute-types">Attribute types</h4>
          <p>The following types are supported by ECM:</p>
          <ul>
            <li><i>boolean</i></li>
            <li><i>byte</i></li>
            <li><i>char</i></li>
            <li><i>double</i></li>
            <li><i>float</i></li>
            <li><i>int</i></li>
            <li><i>long</i></li>
            <li><i>Password</i></li>
            <li><i>short</i></li>
            <li><i>String</i></li>
          </ul>
          <h4 id="attribute-metadata">Attribute metadata</h4>
          <div class="responsive-table">
            <div class="row hidden-xs">
              <div class="col-sm-5 col-md-4 col-lg-3">
                <b>Metadata property</b>
              </div>
              <div class="col-sm-7">
                <b>Description</b>
              </div>
            </div>
            <hr class="double-hr hidden-xs" />
            <div class="empty-separator visible-xs">&nbsp;</div>
            <div id="attribute-id" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Id</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                The id of the attribute that must be unique within the component. When a
                configuration is attached to the <a href="#component-context">component context</a>,
                the keys in the configuration properties should match with the id of the component
                attribute.
              </div>
            </div>
            <hr />
            <div id="attribute-metatype" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Metatype</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                A <i>boolean</i> setting that indicates whether this attribute should be available
                via the <a
                  href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                OSGi service or not.
              </div>
            </div>
            <hr />
            <div id="attribute-label" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Label</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>
                  Human readable format of the <a href="#attribute-id">attribute id</a>. The label
                  is accessible via the <a
                    href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                  OSGi service that is registered together with the <a href="#component-container">component
                    container</a>.
                </p>
                <p>
                  If the label starts with the '<i>%</i>' character, the actual value is read from
                  the resource bundle that is attached to the component. If the resource bundle does
                  not contain the entry with the specific key, the value without the '<i>%</i>'
                  character is returned by the <a
                    href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                  OSGi service.
                </p>
                <p>
                  The default value of the label attribute setting is the concatenation of a '<i>%</i>'
                  character, the <a href="#attribute-id">attribute id</a> and the String "<i>.name</i>".
                  E.g.: If the attribute id is "<i>myAttribute</i>", the default value of the label
                  will be "<i>%myAttribute.name</i>"
                </p>
                <p>
                  This setting is ignored if the value of the <a href="#attribute-metatype">metatype</a>
                  setting is false.
                </p>
              </div>
            </div>
            <hr />
            <div id="attribute-description" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Description</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>
                  The description of the component attribute. The description is accessible via the
                  <a
                    href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                  OSGi service that is registered together with the <a href="#component-container">component
                    container</a>.
                </p>
                <p>
                  If the description starts with the '<i>%</i>' character, the actual value is read
                  from the resource bundle that is attached to the component. If the resource bundle
                  does not contain the entry with the specific key, the value without the '<i>%</i>'
                  character is returned by the <a
                    href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                  OSGi service.
                </p>
                <p>
                  The default value of the label attribute setting is the concatenation of a '<i>%</i>'
                  character, the <a href="#attribute-id">attribute id</a> and the String "<i>.description</i>".
                  E.g.: If the attribute id is "<i>myAttribute</i>", the default value of the
                  description will be "<i>%myAttribute.description</i>"
                </p>
                <p>
                  This setting is ignored if the value of the <a href="#attribute-metatype">metatype</a>
                  setting is false.
                </p>
              </div>
            </div>
            <hr />
            <div id="attribute-default-value" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Default value</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>
                  An attribute can have a default value that is applied when the configuration does
                  not contain any entry with the same key as the id of the attribute. The programmer
                  can specify the default value as an array of the <a href="#attribute-type">attribute
                    type</a>. The meaning of an empty array is
                </p>
                <ul>
                  <li><i>undefined</i> if the value of the <a href="#attribute-multiple">multiple</a>
                    setting is <i>false</i>.</li>
                  <li><i>an empty array</i> if the value of the <a href="#attribute-multiple">multiple</a>
                    setting is <i>true</i>.</li>
                </ul>
                <p>
                  The default value cannot be a multi-element array if the value of the <a
                    href="#attribute-multiple">multiple</a> setting is <i>false</i>.
                </li>
                </p>
              </div>
            </div>
            <hr />
            <div id="attribute-optional" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Optional</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>
                  If the value of the optional setting is <i>true</i>, it is not necessary to define
                  its value.
                </p>
                <p>
                  The <a href="#attribute-setter">setter method</a> of an undefined attribute is not
                  called before the <a href="#activate-method">activate method</a>.
                </p>
                <p>
                  If the attribute is <a href="#attribute-dynamic">dynamic</a>, and its value is
                  changed to <i>undefined</i> together with only other <i>dynamic</i> attributes and
                  references, the <a href="#attribute-setter">setter method</a> of the attribute
                  will be called with <i>null</i> value. The <a href="#attribute-setter">setter
                    method</a> of <a href="#attribute-dynamic">dynamic</a> attributes should always have
                  the class representation of primitive types as the parameter.
                </p>
              </div>
            </div>
            <hr />
            <div id="attribute-multiple" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Multiple</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                Attributes with <i>multiple</i> flag can get arrays as configuration values.
              </div>
            </div>
            <hr />
            <div id="attribute-dynamic" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Dynamic</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>
                  Every time the value of the attribute of an <a href="#state-active">ACTIVE</a>
                  component changes (most likely via Configuration Admin) the following will happen:
                </p>
                <ul>
                  <li>if the attribute is <i>non-dynamic</i>, the component will be restarted.
                  </li>
                  <li>if the attribute is <i>dynamic</i>, the <i>setter</i> method of the
                    component (if there is any) will be called before <a href="#update-method">update
                      method</a>.
                </ul>
              </div>
            </div>
            <hr />
            <div id="attribute-options" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Options</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>
                  Label-Value pairs that are accessible from the <a
                    href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                  OSGi service.
                </p>
                <p>
                  Just like the <a href="#attribute-label">label</a> of the attribute, the label of
                  an option comes from the resource bundle of the component if the label is
                  prepended with the '<i>%</i>' character.
                </p>
              </div>
            </div>
            <hr />
            <div id="attribute-setter" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Setter</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>A component can get the value of an attribute</p>
                <ul>
                  <li>from the <a href="#component-context">component context</a>.
                  </li>
                  <li>by implementing a setter method for the attribute.</li>
                </ul>
                <p>The setter method is called</p>
                <ul>
                  <li>while <a href="#state-starting">starting the component</a> before the <a
                    href="#activate-method">activate method</a>.
                  </li>
                  <li>during a <a href="#state-dynamic-update">dynamic update</a> before the <a
                    href="#update-method">update method</a>.
                  </li>
                </ul>
                <p>The type of the parameter of the setter method can be</p>
                <ul>
                  <li>the type of the attribute.</li>
                  <li>the class representation of the attribute type if the attribute type is
                    primitive.</li>
                  <li>an array of the type of the attribute.</li>
                  <li>an array of the class representation of the attribute type if the
                    attribute type is primitive.</li>
                </ul>
              </div>
            </div>
            <hr />
            <div id="state-inactive" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Priority</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                The attributes are served from the provided <a
                  href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
                in the order of their priority. The type of the priority setting is <i>float</i>.
                The default priority is <i>1000</i>. A smaller number means higher priority. The
                attributes with higher priority will be rendered first on the configuration screen.
              </div>
            </div>
          </div>
          <h3 id="component-reference">Component references</h3>
          <div class="text-center">
            <img alt="Component, Reference, Requirement, Capability relationship"
              src="component-references.svg" class="block-image" />
          </div>
          <p>Components can have zero or more references.</p>
          <h4 id="reference-metadata">Reference metadata</h4>
          <div id="reference-settings" class="responsive-table">
            <div class="row hidden-xs">
              <div class="col-sm-5 col-md-4 col-lg-3">
                <b>Metadata property</b>
              </div>
              <div class="col-sm-7">
                <b>Description</b>
              </div>
            </div>
            <hr class="double-hr hidden-xs" />
            <div class="empty-separator visible-xs">&nbsp;</div>
            <div class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Attribute settings</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                Every setting that an <a href="#attribute-settings">attribute can have</a>.
              </div>
            </div>
            <hr />
            <div id="reference-setting-id" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Reference id</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>
                  The id of the reference. If the <a href="#attribute-id">attribute id</a> is not
                  specified, it will be a concatenation of <i>reference id</i> and the <a
                    href="#reference-setting-configuration-type">configuration type</a>. E.g:
                </p>
                <ul>
                  <li>if the <i>reference id</i> is "<i>myReference</i>", the <a
                    href="#reference-setting-configuration-type">configuration type</a> is <i>filter</i>
                    and the <a href="#attribute-id">attribute id</a> is not specified directly, it
                    will get the "<i>myReference.filter</i>" value.
                  </li>
                  <li>if the <i>reference id</i> is "<i>myReference</i>", the <a
                    href="#reference-setting-configuration-type">configuration type</a> is <i>clause</i>
                    and the <a href="#attribute-id">attribute id</a> is not specified directly, it
                    will get the "<i>myReference.clause</i>" value.
                  </li>
                </ul>
              </div>
            </div>
            <hr />
            <div id="reference-setting-configuration-type" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Configuration type</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                The configuration type of the reference can be either <a
                  href="#reference-config-filter">filter</a> or <a href="#reference-config-clause">clause</a>.
              </div>
            </div>
          </div>

          <p>
            References can have zero or more requirements, based on the <a
              href="#reference-cardinality">cardinality of the reference</a>.
          </p>
          <p>
            The <a href="#component-context">component context</a> <a href="#state-starting">starts</a>
            the component only if all references of the component are satisfied. A reference is
            satisfied if all requirements of the reference are wired to 1-1 matching capability.
          </p>
          <p>Every requirement is specified with the following properties:</p>
          <ul>
            <li><strong>Requirement Id:</strong> The id of the requirement.</li>
            <li><strong>Attributes:</strong> Key-value pairs that can be used by the programmer
              of the component.</li>
            <li><strong>Directives:</strong> At the moment, only <i>filter</i> directive is
              supported. The requirement becomes satisfied, if there is a capability with a specific
              attribute set that matches with OSGi filter expression defined by the filter
              directive.</li>
          </ul>
          <p>
            While <a href="http://wiki.osgi.org/wiki/Declarative_Services">Declarative Services</a>
            supports only one kind of reference, <i>Everit Component Model</i> supports two type of
            requirements: <a href="#requirement-service-reference">OSGi service requirements</a> and
            <a href="#reference-bundle-capability">Bundle-Capability requirements</a>.
          </p>
          <h4 id="reference-config-type">Configuration type</h4>
          <p>
            References have <a href="#component-attribute">attribute</a> behavior. All settings that
            can be applied to an <a href="#component-attribute">attribute</a>, can be applied to a
            reference, too. A reference can also have an <a href="#attribute-id">attribute id</a>
            and the reference can be configured via the <i>Configuration Admin</i>. The type of the
            reference attribute is <i>String</i>, but based on the settings of the reference, it can
            have different meanings.
          </p>
          <h5 id="requirement-config-filter">Filter expression</h5>
          <p>
            Like in <a href="http://wiki.osgi.org/wiki/Declarative_Services">Declarative
              Services</a>, the references of <i>ECM components</i> can also be configured with OSGi
            service filters. E.g.:
          </p>
          <pre>myReference.target = (service.pid=MyDataSource_XXXX-XXXX-XXXX-XXX)</pre>
          <p>If no filter is defined, every capability with the same namespace will match the
            requirement. The filter expression can filter based on the attributes of the capability.</p>
          <p>
            In case the reference configuration is <i>OSGi filter</i> based, each requirement will
            be created with the following definition:
          </p>
          <ul>
            <li><strong>Requirement Id:</strong> An incremented number starting with 0. If the
              <a href="#reference-cardinality">cardinality</a> of the reference allows the
              definition of <i>multiple</i> requirements, the requirement ids in the array of
              requirements will be 0, 1, ...</li>
            <li><strong>Attributes:</strong> The requirements will have no attribute</li>
            <li><strong>Directives:</strong> The requirements will have one <i>filter</i>
              directive if an expression is defined.</li>
          </ul>
          <h5 id="requirement-config-clause">Clause</h5>
          <i>Everit Component Model</i> also supports a more complex configuration mode for
          references. During the development of a component, programmers can specify that a
          reference should be configured with a clause. In general, a clause looks like this:
          <pre>myReference.clause = requirementId;attr1=val1;attr2=val2;filter:=(key=value)</pre>
          A clause is built up from the following parts:
          <ul>
            <li><strong>Requirement Id:</strong> The clause starts with the id of the
              requirement. Requirement id must be unique within the scope of the reference.</li>
            <li><strong>Attributes:</strong> The clause can contain zero or more attributes
              separated by a semicolon. The attribute is built up from a key-value pair where the
              key is separated with an equality (=) character from the value.</li>
            <li><strong>Filter directive:</strong> A filter can be optionally defined. If no
              filter is set, every capability with the same namespace will match the requiement. The
              filter expression can filter based on the attributes of the capability. Directives use
              (:=) as a key-value separator.</li>
          </ul>
          <pre>
servlets.clause = [ "app;url-pattern=/myApp/*;filter:=(service.pid=MyAppServlet_XXXX_XXXX_XXXX_XXXX)",
                   "login;url-pattern=/login;filter:=(service.pid=LoginServlet_XXXX_XXXX_XXXX_XXXX)" ]</pre>
          <p>
            The example above shows a snippet from the configuration of <a
              href="https://github.com/everit-org/jetty-server-ecm">Everit Jetty ServletContext
              Component</a>. The component uses the <i>requirement id</i> as servlet name. In the
            example, two servlets are pulled. They will be accessible on the path that is defined
            with the <i>url-pattern</i> attribute of the clasues.
          </p>

          <h4 id="reference-cardinality">Reference cardinality</h4>
          <p>
            The main difference between <i>Everit Component Model</i> and <a
              href="http://wiki.osgi.org/wiki/Declarative_Services">Declarative Services</a> is how
            they handle the cardinality of references.
          </p>
          <p>
            During the usage of <a href="http://wiki.osgi.org/wiki/Declarative_Services">Declarative
              Services</a>, the programmer can define zero or one OSGi filters to pick up one or more
            OSGi services.
          </p>
          <p>
            In <i>Everit Component Model</i>, the developer can specify zero or more <a
              href="#requirement-config-filter">OSGi filter</a> or <a
              href="#requirement-config-clause">clause</a>. The reference will have as many
            requirement, as many entries are set in the configuration. One requirement must wire to
            exactly one capability.
          </p>
          <p>
            Just like <a href="#attribute-cardinality">attribute cardinality</a>, reference
            cardinality can be specified with <i>optional</i> and <i>multiple</i> properties.
          </p>


          <h4 id="requirement-service-reference">Service reference</h4>

          Like <a href="http://wiki.osgi.org/wiki/Declarative_Services">Declarative Services</a>, <i>Everit
            Component Model</i> supports OSGi Service references, too. The programmer can specify the
          following settings for service references:
          </p>
          <div class="responsive-table">
            <div class="row hidden-xs">
              <div class="col-sm-5 col-md-4 col-lg-3">
                <b>Metadata property</b>
              </div>
              <div class="col-sm-7">
                <b>Description</b>
              </div>
            </div>
            <hr class="double-hr hidden-xs" />
            <div class="empty-separator visible-xs">&nbsp;</div>
            <div class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Reference metadata properties</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                Every setting that an <a href="#referece-settings">reference can have</a>.
              </div>
            </div>
            <hr />
            <div id="service-reference-interface" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Service interface</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>The type of OSGi services that can satisfy the requirements of this
                  reference. As ECM does not use any magic (proxies and bytecode manipulation), the
                  programmer can also specify a class type here.</p>
              </div>
            </div>
            <hr />
          </div>
          <p>
            A <i>service reference</i> can have a <a href="#setter-method">setter method</a> with
            two different parameter types:
          <ul>
            <li><p>The type of the OSGi service that is required</p> <pre
                class="prettyprint lang-java">
public void setOtherService(OtherService otherService) {
  this.otherService = otherService;
}</pre></li>
            <li>An OSGi service type array if the reference cardinality is multiple</li>
            <li><p>
                A parameter with <i>ServiceHolder</i> type. This type can be used to retrieve
                additional information about the reference.
              </p> <pre class="prettyprint lang-java">
public void setOtherService(ServiceHolder&lt;OtherService&gt; holder) {
  // Get the reference id
  String referenceId = holder.getReferenceId();

  // Get the OSGi service reference to analyze its service properties
  ServiceReference&lt;OtherService&gt; serviceReference = holder.getReference();

  // Get the instance to call its functions or assign it to a member variable
  OtherService serviceInstance = holder.getService();

  // Get the attributes defined in the clause of the requirement
  Map&lt;String, Object&gt; attributes = holder.getAttributes();
  
  ...
}</pre></li>
            <li>A <i>ServiceHolder&lt;ServiceType&gt;</i> array if the reference cardinality is
              multiple
            </li>
          </ul>
          <h4 id="reference-bundle-capability">Bundle-Capability reference</h4>
          <p>
            <i>ECM components</i> can not only wire to OSGi services but also to <a
              href="http://wiki.osgi.org/wiki/Provide-Capability">Bundle capabilities</a>. A Bundle
            reference can have the following settings:
          </p>
          <div class="responsive-table">
            <div class="row hidden-xs">
              <div class="col-sm-5 col-md-4 col-lg-3">
                <b>Metadata property</b>
              </div>
              <div class="col-sm-7">
                <b>Description</b>
              </div>
            </div>
            <hr class="double-hr hidden-xs" />
            <div class="empty-separator visible-xs">&nbsp;</div>
            <div class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Reference settings</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                Every setting that an <a href="#referece-settings">reference can have</a>.
              </div>
            </div>
            <hr />
            <div id="bc-reference-namespace" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">Namespace</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                <p>The namespace of the bundle capability that can satisfy the requirements of
                  this reference.</p>
              </div>
            </div>
            <hr />
            <div id="bc-reference-statemask" class="row">
              <div class="col-sm-5 col-md-4 col-lg-3">State mask</div>
              <div class="col-sm-7 col-md-8 col-lg-9">
                The <a
                  href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/Bundle.html#getState()">states</a>
                that bundles can have that satisfy the requirements of this reference. Only the
                following states can be listed for this setting: <a
                  href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/Bundle.html#RESOLVED">RESOLVED</a>,
                <a
                  href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/Bundle.html#STARTING">STARTING</a>,
                <a
                  href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/Bundle.html#STOPPING">STOPPING</a>,
                <a href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/Bundle.html#ACTIVE">ACTIVE</a>.
                By default the <a
                  href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/Bundle.html#ACTIVE">ACTIVE</a>
                state is used in the <i>stateMask</i> setting.
              </div>
            </div>
          </div>
          <p>A Bundle-Capability reference requirement becomes satisfied if there is a Bundle
            with a capability in the OSGi container that is in the necessary state, the attributes
            of the capability match the filter of the requirement and the namespace of the
            capability matches the namespace of the reference.</p>
          <p>The setter of a Bundle-Capability reference can accept one of the following types
            as a parameter:</p>
          <ul>
            <li><a
              href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/wiring/BundleCapability.html">BundleCapability</a></li>
            <li><a
              href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/wiring/BundleCapability.html">BundleCapability</a>
              array if the cardinality of the reference is multiple</li>
            <li><i>BundleCapabilityHolder</i>, that can be used to retrieve the attributes of
              the requirement clause and the id of the requirement</li>
            <li><i>BundleCapabilityHolder</i> array if the cardinality of the reference is
              multiple</li>
          </ul>
          <h3 id="component-capabilities">Component capabilities</h3>
          <h4 id="service-capability">Service capability</h4>
          <p>
            An ECM component can have zero or more capabilities. At the moment, only one type of
            Capability is supported: <i>OSGi service</i>.
          </p>
          <p>
            A <i>Component instance</i> can be registered as an OSGi service automatically. <i>ComponentMetadata</i>
            has a property called <i>service</i>. When this property is defined, the <a
              href="#component-context">component context</a> will register the <i>component
              instance</i> as an OSGi service at the end of the <a href="#state-starting">starting
              process</a>. Depending on the configuration of the service property, the OSGi service will
            be registered with the following interfaces:
          </p>
          <ul>
            <li>if no interface is specified, the OSGi service will be registered with all of
              the interfaces that the component instance implements</li>
            <li>otherwise those interfaces and class types will be used that are specified
              within the property</li>
          </ul>
          <p>
            The programmer can specify the <i>service</i> property via the <i>@Service</i>
            annotation, too.
          </p>
          <p>
            It is also possible to register OSGi services programmatically in the <a
              href="#activate-method">activate method</a> of the component instance. Programmers
            should always use the <a href="#component-context">ComponentContext</a> instance to
            register OSGi services instead of the <i>BundleContext</i>. <a href="#component-context">Component
              context</a> has the same methods for registering OSGi services as <i>BundleContext</i>
            has.
          </p>
          <p>
            When a service is registered via the <a href="#component-context">component context</a>,
            it will appear as the capability of the component. Programmers can query this
            information programmatically, or see it on the <a href="#webconsole-plugin">ECM
              Webconsole Plugin</a> that helps them understanding the architecture of the software.
          </p>
          <p>
            One of the goals of ECM is to speed up failure detection. When a component is <a
              href="#state-unsatisfied">UNSATISFIED</a>, the <a href="#webconsole-plugin"></a> can
            show tips, which components could satisfy their <a href="#component-requirement">requirements</a>.
          </p>

          <h3 id="component-methods">Component methods</h3>
          <h4 id="setter-method">Setters</h4>
          <p>
            Every <a href="#component-attribute">attribute</a> and every <a
              href="#component-reference">reference</a> can have <i>setter</i> method. If an <a
              href="#component-attribute">attribute</a> or a <a href="#component-reference">reference</a>
            has <i>multiple</i> cardinality, the setter parameter must be an array.
          <h4 id="activate-method">Activate method</h4>
          <p>
            The <a href="#component-context">component context</a> calls the activate method of the
            component instance during the <a href="#state-starting">starting process</a> of the
            component. The activate method can have the following type of arguments:
          </p>
          <ul>
            <li><a href="#">ComponentContext</a> that can be used to retrieve all information
              about the component: configuration, metadata, state, ...</li>
            <li><a
              href="https://osgi.org/javadoc/r4v43/core/org/osgi/framework/BundleContext.html">BundleContext</a></li>
          </ul>
          <p>
            If the <a href="#component-metadata">component metadata</a> does not define the
            arguments of the activate method, it will be searched with the following priority:
          </p>
          <ol>
            <li>a method with a ComponentContext parameter</li>
            <li>a method with a BundleContext parameter</li>
            <li>a method with a Map parameter</li>
            <li>a method that contains one or more of the following parameters:
              ComponentContext, BundleContext, Map</li>
            <li>a method without any parameter</li>
          </ol>

          <h4 id="update-method">Update method</h4>
          <p>
            The <a href="#component-context">component context</a> calls the <i>update method</i> of
            the component instance at the end of the <a href="#state-dynamic-update">dynamic
              update</a> process. The method does not take any parameters.
          </p>
          <h4 id="deactivate-method">Deactivate method</h4>
          <p>
            The <a href="#component-context">component context</a> calls the <i>deactivate
              method</i> while <a href="#state-stopping">stopping</a> the component. The method takes no
            parameters.
          </p>
          <h3 id="metatype-support">Metatype support</h3>
          <p>
            Every <a href="#component-container">component container</a> registers itself as an OSGi
            service with the <a
              href="https://osgi.org/javadoc/r4v43/cmpn/org/osgi/service/metatype/MetaTypeProvider.html">MetatypeProvider</a>
            interface if the <i>metatype</i> property of the <a href="#component-metadata">component
              metadata</a> is set to <i>true</i>. For more information, please see the definition of <a
              href="#component-label">label</a> and <a href="#component-description">description</a>
            component settings!
          </p>
          <p>
            It is also possible to set the metatype support for each <a href="#component-attribute">attribute</a>
            and <a href="#component-reference">reference</a> separately. For more information,
            please see the definition of <a href="#attribute-label">label</a> and <a
              href="#attribute-description">description</a> attribute settings!
          </p>
        </div>
      </div>
      <div class="bs-docs-featurette ecm-chapter">
        <h2 id="modules" class="bs-docs-featurette-title ">OSGi Bundles</h2>
        <p>
          ECM is built up from several bundles. Each bundle has its purpose. The separation is
          necessary to keep the technology stable and to be able to fix bugs in short development
          iterations. All bundles are available on <a
            href="http://search.maven.org/#search%7Cga%7C1%7Corg.everit.osgi.ecm">maven-central</a>.
        </p>
        <p class="text-center">
          <img src="ecm-dependency-graph.svg" style="max-width: 100%;" />
        </p>
        <h3 id="ecm-util-method">ECM Util Method</h3>
        <p>
          Helper methods to generate and parse method signatures and to locate methods based on the
          112.9.4 Locating Component Methods chapter of OSGi Compendium Specification. ECM uses the
          same algorithm to resolve <a href="#setter-method">setters</a>, <a href="#activate-method">activate</a>,
          <a href="#update-method">update</a> and <a href="#deactivate-method">deactivate method</a>
          except that ECM only looks for methods with a pulblic modifier.
        </p>
        <h3 id="ecm-metadata">ECM Metadata</h3>
        <p>
          Contains all <a href="#component-metadata">Metadata classes</a> that are necessary to
          instantiate a <a href="#component-container">component container</a>.
        <h3 id="linkage-api">Linkage API</h3>
        <p>The API defines a set of interfaces that can describe entities and their wirings in
          an OSGi container. Entity can be</p>
        <ul>
          <li>Bundles</li>
          <li>OSGi services</li>
          <li>ECM components</li>
          <li>Any other entities that have wirings with other, like Declarative Services
            Components</li>
        </ul>
        <p>ECM implements Linkage API by default. If other technologies implemented it, a
          snapshot could be created about the whole architecture of a running system.</p>
        <h3 id="capability-collector">Capability Collector</h3>
        <p>
          Capability collector is responsible for handling the lifecycle or <a
            href="#component-reference">component references</a> on the low level. Programmers can
          use this library separately to add similar functionality to existing component models like
          ECM has: Handling events when a set of requirements are satisfied.
        </p>
        <h3 id="ecm-component-api">ECM Component API</h3>
        <p>Programmers should add ECM Component API to implement ECM components.</p>

        <h3 id="ecm-component-ri">ECM Component RI</h3>
        <p>The Reference implementation of Everit Component Model specification.</p>
        <h3 id="ecm-annotation">ECM Annotation</h3>
        <p>An annotation set that can be used instead of the programmatic creation of the
          components.</p>
        <h3 id="ecm-annotation-metadatabuilder">ECM Annotation MetadataBuilder</h3>
        <p>
          Util classes to create <a href="#component-metadata">metadata objects</a> from a class
          that is annotated <a href="#ecm-annotation">ECM Annotaitons</a>.
        </p>
        <h3 id="ecm-extender-api">ECM Extender API</h3>
        <p>Constants of ECM Extender. The programmer can use the constants to tell the ECM
          Extender that the annotated class should be picked up.</p>
        <h3 id="ecm-extender-ri">ECM Extender RI</h3>
        <p>
          Reference implementation of the ECM Extender API. For more information, please see the <a
            href="#usage-extender">Using the extender</a> chapter.
        </p>
        <h3 id="ecm-bnd-plugin">ECM Bnd Plugin</h3>
        <p>
          The Bnd plugin processes the annotations of every component in the project and generates
          additional entries to the <i>Provide-Capability</i> MANIFEST header. The Bnd plugin
          processes the following annotations:
        </p>
        <ul>
          <li><p>
              <strong>@Component:</strong> A new Capability is created with <i>org.everit.osgi.ecm.component</i>
              namespace. The following attributes are specified within this capability:
            </p>
            <ul>
              <li><p>
                  <strong>componentId:</strong> The id of the component
                </p></li>
              <li><p>
                  <strong>class:</strong> The type of the component
                </p></li>
              <li><p>
                  <strong>label:</strong> The label of the component. If the label is localized, the
                  value is replaced with the locale of the default language.
                </p></li>
              <li><p>
                  <strong>description:</strong> The description of the component. If the description
                  is localized, the value is replaced with the locale of the default language.
                </p></li>
            </ul></li>
          <li><p>
              <strong>@Service:</strong> The plugin generates a capability with the <i>osgi.service</i>
              namespace. The following attributes are specified for the capability:
            </p>
            <ul>
              <li><p>
                  <strong>objectClass:</strong> List of the name of the types that the service is
                  registered with.
                </p></li>
              <li><p>
                  <strong>org.everit.osgi.ecm.component.id:</strong> The id of the component that
                  registers this service.
                </p></li>
            </ul></li>
          <li><p>
              <strong>@ManualService:</strong> The plugin generates a capability with the <i>osgi.service</i>
              namespace for each <i>@ManualService</i> annotations. The following attributes are
              specified for the capability:
            </p>
            <ul>
              <li><p>
                  <strong>objectClass:</strong> List of the name of the types that the service is
                  registered with.
                </p></li>
              <li><p>
                  <strong>org.everit.osgi.ecm.component.id:</strong> The id of the component that
                  registers this service.
                </p></li>
            </ul></li>
        </ul>
      </div>
      <div class="bs-docs-featurette ecm-chapter">
        <h2 id="webconsole-plugin" class="bs-docs-featurette-title ">Webconsole plugin</h2>
        <div class="text-center" style="padding-bottom: 1em;">
          <img src="ecm-webconsole.png" style="max-width: 100%;" />
        </div>
        <p>ECM has a webconsole plugin that</p>
        <ul>
          <li>shows each <a href="#component-container">component containers</a> with grey
            background.
          </li>
          <li>shows the state of all of the <a href="#component-context">component contexts</a>.
          </li>
          <li>shows the <a href="#component-requirement">requirements</a> and <a
            href="#component-capability">capabilities</a> of every component.
          </li>
          <li>provides links to create, modify or delete the configuration of components.</li>
          <li>provides links within the description of <a href="#component-requirement">requirements</a>
            and <a href="#component-capability">capabilities</a> to let the programmer walking
            through the component wiring graphs.
          </li>
          <li><i>Coming soon:</i> provides tips for <a href="#state-unsatisfied">unsatisfied</a>
            requirements to be able to find the missing capability easily.</li>
        </ul>
      </div>
    </div>
    <div class="col-md-2">
      <nav id="affix-nav">
        <ul class="nav nav-pills nav-stacked everit-affix affix-top" data-spy="affix"
          data-offset-top="350" data-offset-bottom="140">
          <li><a href="#introduction">Introduction</a></li>
          <li><a href="#quickstart">Quick start</a>
            <ul class="nav nav-pills nav-stacked">
              <li><a href="#usage-extender">Using the extender</a></li>
              <li><a href="#usage-bnd">Adding the Bnd plugin</a></li>
              <li><a href="#usage-programmatic">Programmatic way</a></li>
            </ul></li>
          <li class=""><a href="#specification">Specification</a>
            <ul class="nav nav-pills nav-stacked">
              <li><a href="#component-metadata">Component metadata</a></li>
              <li><a href="#component-container">Component container</a></li>
              <li><a href="#component-context">Component context</a></li>
              <li><a href="#component-lifecycle">Lifecycle</a>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="#component-states">States</a></li>
                  <li><a href="#state-transitions">Transitions</a></li>
                </ul></li>
              <li><a href="#component-attributes">Attributes</a>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="#attribute-types">Attribute types</a></li>
                  <li><a href="#attribute-metadata">Metadata</a></li>
                </ul></li>
              <li><a href="#component-reference">References</a>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="#reference-metadata">Metadata</a></li>
                  <li><a href="#reference-config-type">Configuration types</a></li>
                  <li><a href="#reference-cardinality">Cardinality</a></li>
                  <li><a href="#requirement-service-reference">Service ref.</a></li>
                  <li><a href="#reference-bundle-capability">Bundle-Capability ref.</a></li>
                </ul></li>
              <li><a href="#component-capabilities">Capabilities</a>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="#service-capability">Service cap.</a></li>
                </ul></li>
              <li><a href="#component-methods">Methods</a>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="#setter-method">Setter</a></li>
                  <li><a href="#activate-method">Activate</a></li>
                  <li><a href="#update-method">Update</a></li>
                  <li><a href="#deactivate-method">Deactivate</a></li>
                </ul></li>
              <li><a href="#metatype-support">Metatype support</a></li>
            </ul></li>
          <li><a href="#modules">OSGi Bundles</a>
            <ul class="nav nav-pills nav-stacked">
              <li><a href="#ecm-util-method">ECM Util Method</a></li>
              <li><a href="#ecm-metadata">ECM Metadata</a></li>
              <li><a href="#linkage-api">Linkage API</a></li>
              <li><a href="#capability-collector">Capability collector</a></li>
              <li><a href="#ecm-component-api">ECM Component API</a></li>
              <li><a href="#ecm-component-ri">ECM Component RI</a></li>
              <li><a href="#ecm-annotation">ECM Annotation</a></li>
              <li><a href="#ecm-annotation-metadatabuilder">ECM Metadata Builder</a></li>
              <li><a href="#ecm-extender-api">ECM Extender API</a></li>
              <li><a href="#ecm-extender-ri">ECM Extender RI</a></li>
              <li><a href="#ecm-bnd-plugin">ECM Bnd Plugin</a></li>
            </ul></li>
          <li><a href="#webconsole-plugin">Webconsole plugin</a></li>
        </ul>
      </nav>
    </div>
  </div>


  <!-- Footer
================================================== -->
  <div></div>
  <footer class="bs-docs-footer" role="contentinfo">
    <div class="container">
      <div class="bs-docs-social">
        <ul class="bs-docs-social-buttons">
          <li class="follow-btn"><a href="https://twitter.com/EveritOrg"
            class="twitter-follow-button" data-show-count="true">Follow @EveritOrg</a></li>
          <li class="tweet-btn"><a href="https://twitter.com/share"
            class="twitter-share-button" data-url="http://www.everit.org/">Tweet</a></li>
        </ul>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/bootstrap.min.js"></script>
  <script src="../js/everit.js"></script>
  <script type="text/javascript">
      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl'
            : 'http://www')
            + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <script src="../js/prettify/run_prettify.js"></script>
</body>

</html>
